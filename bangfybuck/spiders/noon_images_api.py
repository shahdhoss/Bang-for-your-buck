import requests
import json
def noon_api(query):
  url = f"https://www.noon.com/_next/data/bigalog-674fada3122fbe2b89eacee71ea4b2a6ca5a68a2/egypt-en/search.json?limit=50&originalQuery={query}&page=1&q={query}&sort%5Bby%5D=popularity&sort%5Bdir%5D=desc&catalog=search"

  payload = {}
  headers = {
    'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',
    'accept-language': 'en-US,en;q=0.9',
    'cookie': 'visitor_id=d0921824-ff81-4363-9803-2db243d8dcc3; __rtbh.lid=%7B%22eventType%22%3A%22lid%22%2C%22id%22%3A%22MwZ5ToGEiudbX77GWo4A%22%7D; _ga=GA1.2.1238261748.1707320681; _scid=7d188449-398c-4317-8f70-992c1eb667da; _tt_enable_cookie=1; _ttp=9-ZQRymn8C6BG5DKLJSJtMcB7lx; __zlcmid=1KCmTphDS9VzASi; nguestv2=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJraWQiOiIwMjk3ZTU2MjI5YWM0ZDUyYjMzNDUyYTVmZGU3YmI0ZCIsImlhdCI6MTcxMjI2NjYwNSwiZXhwIjoxNzEyMjY2OTA1fQ.pjTKw4RIfAEfqQ7vXJFr5iO8ntiZytXKMsiDotpXQBE; _gcl_au=1.1.927758058.1720804665; _fbp=fb.1.1720804666422.472561901428814707; th_capi_em=9b270b2fb7288a0da4925db4f4a3ae9d05986b51a86c39b0489d31c34abc98fb; _nrtnetid="nav1.public.eyJ1c2VySWQiOiIyOTc1MTExYy1lZjQyLTQ4OWQtODUxMi1iNDc4MGMwYTkyNWMiLCJzaWQiOiJlM2FlM2Q5OS1kMjNjLTQ1YWYtYmQyOC03NzI1MzdmN2I3NDYiLCJ0aWQiOiIwY2ZhNjdhMDJjNWUxMGNiY2U1MTUwYzlhOTg0M2FmY2QyOGY4YzhmOWY3NjNjN2Y2MWEyZDE0YmIwYWE3YjBhIiwiaWF0IjoxNzIyMzM5MzYxfXlVTHRsQWVXL1VkaFlQYUZScWl6MDBweUtpMldUcEsxbEJWOTFTV2FVdUt6U1B0UDRiQSsxbjRjMUpYTmdTN1Mya01tMEk1bnFMbzBUNGlUYkVXMTkxNlJPNCthNkE4a3VTd21yemdoOXliMHR5OHNQUWlIVFVRd1lKN3R0Q2JwYWpwcE11Q0dKQUZDMUJJTUUydkVNaGNTWmF5dEI2UW1NNlVBN1N4WUptMTFuK1kwaHVEdGwyN2Q5cGdzK3pyNGl1WmcvUkJuck12c0xmMHRiZ2k0VkpiSkYrRFc1QXNLQmlON3VxOU1iQVhuMHpXMjZNc2NpZjJ0VlYzVUFyZXVtd09kaUNYdDdxMnhrdkFDZHUzV2xEUytZZWduK1pjWkxuOWdqQkdidVUrdkJvL2s0MWQvdmYzRXVyc0dKZzMwcWhmd1I3MGYyKzgra1BMdjF2QUNuaTJFS0VEa0tvS0xYMVVNZjc5RVdqWVQzS0FGV0VYM2NCSmREVUhXNFF1YStKS1VSK0cxVlNZWHdDVk5rWDhkWW1acndZb3JsbUpaeDRVcHkxUTZQZ1NscXpWei9jLzRVV3JLSVJFcUkvQlJCMXdXRVBTM2lONzBQQ0tXZXUycmdkcEJMaWFRY0JCWFNQeGFacm82R0laa0VYU3g2ZXJIb1FzcjF2MVI5Y2NO.MQ=="; nguestv2=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJraWQiOiIzNDU3ZjE4YWE3Mzk0YWZhYTI1ODk4NTE5YjczNDFhNCIsImlhdCI6MTcyMjMzOTM2MSwiZXhwIjoxNzIyMzM5NjYxfQ.nDgTCJqk_29Aj-ymVmw5vteYBMOmvtJ_ofF8hCBlPw0; __rtbh.uid=%7B%22eventType%22%3A%22uid%22%2C%22id%22%3A%229b270b2fb7288a0da4925db4f4a3ae9d05986b51a86c39b0489d31c34abc98fb%22%7D; th_capi_ph=e83fea565faae9fbfb65da51ced93af35e393a87014641f444f5546b9e99c099; th_capi_fn=b0151ab2f2292501b2577f161d3d7ab825942bd5f48856cac9149db52355275e; th_capi_ln=3b9b21b853639a9b7c1ce503095776aba9c567961c27a665a3cd87702a8acc3d; x-location-ecom-eg=eyJsYXQiOiAzMDMwOTc4MjYsICJsbmciOiAzMTc2MzU2OTgsICJhZGRyZXNzX2NvZGUiOiAiNWI5OGY5NDA4NGJlZTQ0MWYwNzAwNjQwZDcwNmI0YjIiLCAiYXJlYSI6ICJVbm5hbWVkIFJvYWQgLSAxMHRoIG9mIFJhbW1hZGFuIFNlY29uZCAtIEFsLVNoYXJxaWEgR292ZXJub3JhdGUifQ; dceg=213; _ScCbts=%5B%22572%3Bchrome.2%3A2%3A5%22%5D; _sctr=1%7C1725483600000; ak_bmsc=617DD6D514F51EBA6B444BC6DB770F79~000000000000000000000000000000~YAAQh+F6XB0hOdeRAQAAr4cE4hnbuRs6rL2tf1TnF5VnEZPMyo5zqhIr+JFptUU3VbKS1P7NwrrQIDVEpGz02nD2Ft5Y7cQ6M6ZBN115nIFpwfYCzIVYe8s2MIdKiu3sO8I3U4GvFEiI3w6EvhEIdGRtGUiAJxlKUqrMNI6fffS1OPcHwoLME+h59heNun4Xa9ghpGrKZGLE0q3JOKERrker0xo77Dwfi7fnYAmoBEr58wWXkVKH+lxb3v8SMQJcnfs4OXGerwqHN333tvR2hAGS9m1ZIwXEC0XXGkLtpd2YDY5Wuf8EPnPTiMPKiwjvXs3PqSu+8HL/LVe+0+oZySM2HZb6+ETYtMqT5cEr3c7lSqZ6XAKoAwGkfUTOCisaHHxmfKMLN6XxLyFKte7eY5ALTPQUFAWmKanPM3xW5V9E2tr/OMWf9YUa7VEfgIJL0GfFAvHC4HbEIzM=; _gid=GA1.2.1683692230.1726073833; ZLD887450000000002180avuid=550b2a93-f66c-41dc-8b24-dee924029456; _clck=7ik4qr%7C2%7Cfp3%7C0%7C1498; __gads=ID=a0537c61a7b8063a:T=1707320684:RT=1726073834:S=ALNI_MbKGaO1juu7nZPNIYzbJHhS-HB24w; __gpi=UID=00000d181a74676b:T=1707320684:RT=1726073834:S=ALNI_MYLnMbEdoZfccU4lBMdYDCrdUV4Gw; __eoi=ID=e4a8c4c2a7ec0b75:T=1724230651:RT=1726073834:S=AA-AfjYUjdj6iXukR2qYD3nIyx4k; AKA_A2=A; RT="z=1&dm=noon.com&si=0212f3d9-e0eb-4b22-bd0d-beb59b43a9f5&ss=m0y7e6ht&sl=0&tt=0"; nloc=en-ae; _natnetidv2=eyJhbGciOiJLTVNSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdGlkIjoiMGNmYTY3YTAyYzVlMTBjYmNlNTE1MGM5YTk4NDNhZmNkMjhmOGM4ZjlmNzYzYzdmNjFhMmQxNGJiMGFhN2IwYSIsInNpZCI6ImUzYWUzZDk5LWQyM2MtNDVhZi1iZDI4LTc3MjUzN2Y3Yjc0NiIsInd0aWQiOiI3MTI0NmNhOS03MzJmLTRkZGQtYmU1OC03YWQ2M2U0NWI0NWIiLCJpYXQiOjE3MjYwODAwNTIsImV4cCI6MTcyNjA4MDM1Mn0.WRvga1vgnbD6WuyiVyM96CLKL5EkoJZO1VobrU4SDLSycql71hG4EBNhJYYdUj8iCxz3QS9axXTK83Ao5t_tflGRrC0zOzyWtKXWzQc-Abg9Wt0Fj_001cFwpkapd51dC4VQHubW56yoeIFqrylIn9xADpScUWmvdl6qkFGUE_JWh47gTrsqWQDRNzM_Ol_8W5DS_fz9s18dCY9MKmZ5amLqn15c49fWcVLFBMY7giEYiwrLpQ28vNM592mAWTow49sxqVpVZnJpGVELjtamTNx9owaaogNHse2t9DBJTaJ1OVdRdVPQUBh38x4DsICUnCrn3YZbaV_LLF_o6OSRYDR1GkQbsqMXccsEr8E06dZmaFGH-X7w-yNipL4Hna_LAJRmNUzy1EuZyK7Nw9099SGTy8uubeu7dSFYYL00ASlgsjVzTds_s2PjxpeGpxU2kEh8G93wXnDJ1uuUXecikBP-g6_7q-h0tMtRwyV10DnZFDpOTpSJaTPEBgt88UCc; noonengr-_zldp=dbw5UOFoeCyzHuNR21Yh%252FE3TgNroVp2EhgSuotUcY2urt5KTsXreb%252BM8QEeA9XAMmKwM1K1ctjo%253D; ZLDsiq663f5c2580454f7ed6b7bbe12e575c5570eb9b21832ce32b902ca6cbca6ffc2bavuid=550b2a93-f66c-41dc-8b24-dee924029456; _ym_uid=1726080053287179173; _ym_d=1726080053; _etc=bOu15IXg5Pwk7J8h; _scid_r=X0V9GIRJOYwVF7pwmSwetmfaOZFTdAEIVBQr-g; _uetsid=e43095c0705e11efbf569d23566fe60a; _uetvid=ce9ab230c5cf11eeb9db41a7d6d301e5; ZLDsiq3b3ce696144e42ab351af48092266ce3dda2b3c7b2ad6e09ba5d18504de03180tabowner=undefined; x-whoami-headers=eyJ4LWxhdCI6IjI1MTk5ODQ5NSIsIngtbG5nIjoiNTUyNzE1OTg1IiwieC1hYnkiOiJ7XCJwb192Mi5lbmFibGVkXCI6MSxcInBkcF9ib3MuZW5hYmxlZFwiOjEsXCJtcF9pY29uX3YyLmVuYWJsZWRcIjoxLFwicGRwX2ZseW91dC5mbHlvdXRfdmFsdWVcIjowLFwiY2F0ZWdvcnlfYmVzdF9zZWxsZXIuZW5hYmxlZFwiOjEsXCJwZHBfc2NyZWVuc2hvdF9zaGFyZV9zaGVldC5lbmFibGVkXCI6MX0iLCJ4LWVjb20tem9uZWNvZGUiOiJBRV9EWEItUzUiLCJ4LWFiLXRlc3QiOls4MzAsODUxLDkwMSw5MTEsOTUxLDk2MV0sIngtcm9ja2V0LXpvbmVjb2RlIjoiVzAwMDY3NTI2QSIsIngtcm9ja2V0LWVuYWJsZWQiOnRydWUsIngtYm9yZGVyLWVuYWJsZWQiOnRydWV9; bm_sv=3151F9BB649724E502A6AB115480D175~YAAQTeF6XHtiyOGRAQAACktl4hl1aMZFN6BMh3e+Hu+dj1wqa/VxhwvNgLiFHlxZjTOpAdfmT8+aR197J29F/mq2HRhxkhD9MRfvQYQ18XbcDyRcYoW0Xylt/CqX2YDb3Ys7YUkUYFdbW6Jw1ACd5bOugx3RMW3ctdB3fO8IR3MHWQHF0Br/cM51d3o7iOQQlWdmFwLVo65qXLp0wYIC9FkpT+iCqNuf8uiu1VDdqFwJRZ9r804OBIZ6ExuKgY4=~1; _clsk=m7vipw%7C1726080175616%7C4%7C0%7Cn.clarity.ms%2Fcollect; _gat_UA-84507530-14=1; bm_sv=3151F9BB649724E502A6AB115480D175~YAAQh+F6XOLLOteRAQAAH9Bm4hkjUv82aO5rBXzRFuCdPP4xQhxdoPmOY9c7Y6KPJdyQJs/eQIXeNvWwVGRQRwhcx2c7wTu54xFyirsURHsR0QwoJSy9YXXBnJb9wLgiaPZpWmyRRBRX3MfkpNWaYxYthfRam1mSFTI0IPw7q1zWp1jGdH+zLGn1U22I4BqJjlwScOAcUKkXPq+M8SiLwkRJeQpM43VAidH35q0t+9npjTsCHcJ4U/ZH1hVSanM=~1; x-whoami-headers=eyJ4LWxhdCI6IjMwMzA5NzgyNiIsIngtbG5nIjoiMzE3NjM1Njk4IiwieC1hYnkiOiJ7XCJwZHBfYm9zLmVuYWJsZWRcIjoxLFwibXBfaWNvbl92Mi5lbmFibGVkXCI6MSxcInBkcF9mbHlvdXQuZmx5b3V0X3ZhbHVlXCI6MCxcImNhdGVnb3J5X2Jlc3Rfc2VsbGVyLmVuYWJsZWRcIjoxLFwicGRwX3NjcmVlbnNob3Rfc2hhcmVfc2hlZXQuZW5hYmxlZFwiOjF9IiwieC1lY29tLXpvbmVjb2RlIjoiRUctQ0FJLVMxIiwieC1hYi10ZXN0IjpbODMwLDg1MSw5MTEsOTUxLDk2MV19',
    'priority': 'u=0, i',
    'sec-ch-ua': '"Chromium";v="128", "Not;A=Brand";v="24", "Google Chrome";v="128"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Windows"',
    'sec-fetch-dest': 'document',
    'sec-fetch-mode': 'navigate',
    'sec-fetch-site': 'none',
    'sec-fetch-user': '?1',
    'upgrade-insecure-requests': '1',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36'
  }

  response = requests.request("GET", url, headers=headers, data=payload)
  data=response.json()
  noon_data=[]
  for hit in data['pageProps']['catalog']['hits']:
      item_data = {
                      "name": hit['brand']+ ' '+ hit['name'],
                      'picture': 'https://f.nooncdn.com/p/'+hit['image_key']+'.jpg?format=avif&width=400',
                      'flags': hit['flags']
                  }
      noon_data.append(item_data)

  with open("noon_images.json",'w') as file:
      json.dump(noon_data,file,indent=4)

    
